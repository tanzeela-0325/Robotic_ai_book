"use strict";(globalThis.webpackChunkai_humanoid_robotics_book=globalThis.webpackChunkai_humanoid_robotics_book||[]).push([[835],{2298(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"modules/module-1-ros-nervous-system/chapter-3-python-ai-agents","title":"Chapter 3: Python AI Agents with rclpy","description":"Introduction","source":"@site/docs/modules/module-1-ros-nervous-system/chapter-3-python-ai-agents.md","sourceDirName":"modules/module-1-ros-nervous-system","slug":"/modules/module-1-ros-nervous-system/chapter-3-python-ai-agents","permalink":"/Robotic_ai_book/docs/modules/module-1-ros-nervous-system/chapter-3-python-ai-agents","draft":false,"unlisted":false,"editUrl":"https://github.com/tanzeela-0325/Robotic_ai_book/edit/main/docs/modules/module-1-ros-nervous-system/chapter-3-python-ai-agents.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 2: Nodes, Topics, Services, and Actions","permalink":"/Robotic_ai_book/docs/modules/module-1-ros-nervous-system/chapter-2-nodes-topics-services"},"next":{"title":"Chapter 4: URDF/XACRO and Humanoid Morphology","permalink":"/Robotic_ai_book/docs/modules/module-1-ros-nervous-system/chapter-4-urdf-xacro-morphology"}}');var a=t(4848),i=t(8453);const r={},l="Chapter 3: Python AI Agents with rclpy",o={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Understanding rclpy",id:"understanding-rclpy",level:2},{value:"What is rclpy?",id:"what-is-rclpy",level:3},{value:"Key Concepts in rclpy",id:"key-concepts-in-rclpy",level:3},{value:"Node Lifecycle",id:"node-lifecycle",level:4},{value:"Callbacks and Events",id:"callbacks-and-events",level:4},{value:"Creating Basic AI Agents",id:"creating-basic-ai-agents",level:2},{value:"Simple Node Template",id:"simple-node-template",level:3},{value:"AI Agent Architecture Patterns",id:"ai-agent-architecture-patterns",level:3},{value:"State Machine Approach",id:"state-machine-approach",level:4},{value:"Behavior-Based Architecture",id:"behavior-based-architecture",level:4},{value:"AI Agent Communication Patterns",id:"ai-agent-communication-patterns",level:2},{value:"Sensor Data Processing",id:"sensor-data-processing",level:3},{value:"Decision Making with ROS Services",id:"decision-making-with-ros-services",level:3},{value:"Advanced AI Agent Features",id:"advanced-ai-agent-features",level:2},{value:"Multi-threading Considerations",id:"multi-threading-considerations",level:3},{value:"Parameter Management",id:"parameter-management",level:3},{value:"Integration with ROS 2 Systems",id:"integration-with-ros-2-systems",level:2},{value:"ROS 2 Actions for Long-Running Tasks",id:"ros-2-actions-for-long-running-tasks",level:3},{value:"Safety and Error Handling",id:"safety-and-error-handling",level:2},{value:"Graceful Degradation",id:"graceful-degradation",level:3},{value:"Testing and Debugging",id:"testing-and-debugging",level:2},{value:"Unit Testing AI Agents",id:"unit-testing-ai-agents",level:3},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"chapter-3-python-ai-agents-with-rclpy",children:"Chapter 3: Python AI Agents with rclpy"})}),"\n",(0,a.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,a.jsxs)(n.p,{children:["Python AI agents form the cognitive layer of modern humanoid robots, bridging the gap between high-level decision-making and low-level robotic control. The ",(0,a.jsx)(n.code,{children:"rclpy"})," library provides the foundation for creating these agents within the ROS 2 ecosystem."]}),"\n",(0,a.jsx)(n.h2,{id:"understanding-rclpy",children:"Understanding rclpy"}),"\n",(0,a.jsx)(n.h3,{id:"what-is-rclpy",children:"What is rclpy?"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"rclpy"})," is the Python client library for ROS 2, providing the necessary tools to create nodes, handle communication, and interact with the ROS 2 infrastructure. It offers:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Node creation and lifecycle management"}),"\n",(0,a.jsx)(n.li,{children:"Publisher and subscriber functionality"}),"\n",(0,a.jsx)(n.li,{children:"Service and action server/client implementation"}),"\n",(0,a.jsx)(n.li,{children:"Timer and callback mechanisms"}),"\n",(0,a.jsx)(n.li,{children:"Parameter handling and configuration"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"key-concepts-in-rclpy",children:"Key Concepts in rclpy"}),"\n",(0,a.jsx)(n.h4,{id:"node-lifecycle",children:"Node Lifecycle"}),"\n",(0,a.jsx)(n.p,{children:"Every rclpy node follows a defined lifecycle:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Initialization"}),": Node creation and parameter setup"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Activation"}),": Node becomes active and starts processing"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Deactivation"}),": Node temporarily stops processing"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Cleanup"}),": Resource release and shutdown"]}),"\n"]}),"\n",(0,a.jsx)(n.h4,{id:"callbacks-and-events",children:"Callbacks and Events"}),"\n",(0,a.jsx)(n.p,{children:"rclpy uses callbacks for asynchronous event handling:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Timer callbacks"}),": Scheduled periodic execution"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Subscription callbacks"}),": Triggered on message reception"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Service callbacks"}),": Invoked on service request"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Action callbacks"}),": Handle goal acceptance and feedback"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"creating-basic-ai-agents",children:"Creating Basic AI Agents"}),"\n",(0,a.jsx)(n.h3,{id:"simple-node-template",children:"Simple Node Template"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\nclass SimpleAgent(Node):\n    def __init__(self):\n        super().__init__('simple_agent')\n\n        # Create a timer for periodic execution\n        self.timer = self.create_timer(1.0, self.timer_callback)\n\n        # Create a publisher\n        self.publisher = self.create_publisher(\n            String, '/simple_topic', 10)\n\n        # Create a subscriber\n        self.subscription = self.create_subscription(\n            String, '/simple_topic', self.subscription_callback, 10)\n\n    def timer_callback(self):\n        # Periodic task execution\n        msg = String()\n        msg.data = 'Hello from SimpleAgent'\n        self.publisher.publish(msg)\n\n    def subscription_callback(self, msg):\n        # Handle incoming messages\n        self.get_logger().info(f'Received: {msg.data}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = SimpleAgent()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,a.jsx)(n.h3,{id:"ai-agent-architecture-patterns",children:"AI Agent Architecture Patterns"}),"\n",(0,a.jsx)(n.h4,{id:"state-machine-approach",children:"State Machine Approach"}),"\n",(0,a.jsx)(n.p,{children:"For complex decision-making, AI agents often use finite state machines:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"class StateMachineAgent(Node):\n    def __init__(self):\n        super().__init__('state_machine_agent')\n        self.state = 'IDLE'\n\n    def process_command(self, command):\n        if self.state == 'IDLE':\n            if command == 'start':\n                self.state = 'ACTIVE'\n                return 'Transitioning to active state'\n        elif self.state == 'ACTIVE':\n            if command == 'pause':\n                self.state = 'PAUSED'\n                return 'Transitioning to paused state'\n            elif command == 'stop':\n                self.state = 'IDLE'\n                return 'Transitioning to idle state'\n        return 'No change in state'\n"})}),"\n",(0,a.jsx)(n.h4,{id:"behavior-based-architecture",children:"Behavior-Based Architecture"}),"\n",(0,a.jsx)(n.p,{children:"More sophisticated agents use behavior-based approaches:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"class BehaviorBasedAgent(Node):\n    def __init__(self):\n        super().__init__('behavior_based_agent')\n        self.behaviors = []\n\n    def add_behavior(self, behavior):\n        self.behaviors.append(behavior)\n\n    def evaluate_behaviors(self):\n        # Evaluate all behaviors and select highest priority\n        selected_behavior = max(self.behaviors,\n                               key=lambda b: b.priority)\n        return selected_behavior.execute()\n"})}),"\n",(0,a.jsx)(n.h2,{id:"ai-agent-communication-patterns",children:"AI Agent Communication Patterns"}),"\n",(0,a.jsx)(n.h3,{id:"sensor-data-processing",children:"Sensor Data Processing"}),"\n",(0,a.jsx)(n.p,{children:"AI agents often process sensor data to make decisions:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"class SensorProcessingAgent(Node):\n    def __init__(self):\n        super().__init__('sensor_processing_agent')\n\n        # Subscribe to multiple sensor topics\n        self.camera_sub = self.create_subscription(\n            Image, '/camera/image_raw', self.camera_callback, 10)\n        self.imu_sub = self.create_subscription(\n            Imu, '/imu/data', self.imu_callback, 10)\n        self.lidar_sub = self.create_subscription(\n            LaserScan, '/lidar/scan', self.lidar_callback, 10)\n\n    def camera_callback(self, msg):\n        # Process image data\n        processed_data = self.process_image(msg)\n        # Publish processed data\n        self.image_processed_pub.publish(processed_data)\n\n    def imu_callback(self, msg):\n        # Process IMU data for balance control\n        balance_data = self.process_imu(msg)\n        # Send to balance controller\n        self.balance_pub.publish(balance_data)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"decision-making-with-ros-services",children:"Decision Making with ROS Services"}),"\n",(0,a.jsx)(n.p,{children:"AI agents often interact with planning services:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"class DecisionMakingAgent(Node):\n    def __init__(self):\n        super().__init__('decision_making_agent')\n\n        # Create service client for path planning\n        self.path_planning_client = self.create_client(\n            NavigateToPose, '/navigate_to_pose')\n\n        # Create service server for agent commands\n        self.command_service = self.create_service(\n            Trigger, '/agent_command', self.command_callback)\n\n    def make_decision(self, situation):\n        # Complex decision making logic\n        if situation == 'obstacle_detected':\n            # Request alternative path\n            future = self.path_planning_client.call_async(\n                self.create_navigation_goal())\n            return future\n        elif situation == 'task_complete':\n            # Signal completion\n            return self.signal_completion()\n"})}),"\n",(0,a.jsx)(n.h2,{id:"advanced-ai-agent-features",children:"Advanced AI Agent Features"}),"\n",(0,a.jsx)(n.h3,{id:"multi-threading-considerations",children:"Multi-threading Considerations"}),"\n",(0,a.jsx)(n.p,{children:"For computationally intensive tasks, AI agents may need to use threading:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import threading\nfrom concurrent.futures import ThreadPoolExecutor\n\nclass ConcurrentAgent(Node):\n    def __init__(self):\n        super().__init__('concurrent_agent')\n        self.executor = ThreadPoolExecutor(max_workers=4)\n\n    def process_heavy_task(self, data):\n        # Heavy computation that shouldn't block the main thread\n        result = self.heavy_computation(data)\n        return result\n\n    def callback_with_threading(self, msg):\n        # Submit heavy computation to thread pool\n        future = self.executor.submit(\n            self.process_heavy_task, msg.data)\n        # Handle result asynchronously\n        future.add_done_callback(self.handle_result)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"parameter-management",children:"Parameter Management"}),"\n",(0,a.jsx)(n.p,{children:"AI agents often need configurable parameters:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"class ConfigurableAgent(Node):\n    def __init__(self):\n        super().__init__('configurable_agent')\n\n        # Declare parameters\n        self.declare_parameter('sensitivity', 0.5)\n        self.declare_parameter('timeout', 5.0)\n        self.declare_parameter('max_speed', 1.0)\n\n        # Get parameters\n        self.sensitivity = self.get_parameter('sensitivity').value\n        self.timeout = self.get_parameter('timeout').value\n        self.max_speed = self.get_parameter('max_speed').value\n\n    def update_parameters(self):\n        # Dynamic parameter updates\n        new_sensitivity = self.get_parameter('sensitivity').value\n        if new_sensitivity != self.sensitivity:\n            self.sensitivity = new_sensitivity\n            self.update_sensitivity(new_sensitivity)\n"})}),"\n",(0,a.jsx)(n.h2,{id:"integration-with-ros-2-systems",children:"Integration with ROS 2 Systems"}),"\n",(0,a.jsx)(n.h3,{id:"ros-2-actions-for-long-running-tasks",children:"ROS 2 Actions for Long-Running Tasks"}),"\n",(0,a.jsx)(n.p,{children:"AI agents often need to coordinate with long-running operations:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from action_msgs.msg import GoalStatus\nfrom nav2_msgs.action import NavigateToPose\n\nclass ActionAwareAgent(Node):\n    def __init__(self):\n        super().__init__('action_aware_agent')\n\n        # Create action client for navigation\n        self.nav_client = ActionClient(\n            self, NavigateToPose, '/navigate_to_pose')\n\n    def initiate_navigation(self, target_pose):\n        # Create goal\n        goal_msg = NavigateToPose.Goal()\n        goal_msg.pose = target_pose\n\n        # Send goal and handle feedback\n        future = self.nav_client.send_goal_async(goal_msg)\n        future.add_done_callback(self.goal_response_callback)\n\n    def goal_response_callback(self, future):\n        goal_handle = future.result()\n        if not goal_handle.accepted:\n            self.get_logger().info('Goal rejected')\n            return\n\n        # Get feedback\n        self._get_result_future = goal_handle.get_result_async()\n        self._get_result_future.add_done_callback(self.get_result_callback)\n\n    def get_result_callback(self, future):\n        result = future.result().result\n        self.get_logger().info(f'Navigation result: {result}')\n"})}),"\n",(0,a.jsx)(n.h2,{id:"safety-and-error-handling",children:"Safety and Error Handling"}),"\n",(0,a.jsx)(n.h3,{id:"graceful-degradation",children:"Graceful Degradation"}),"\n",(0,a.jsx)(n.p,{children:"AI agents should handle failures gracefully:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"class SafeAgent(Node):\n    def __init__(self):\n        super().__init__('safe_agent')\n        self.health_monitor = self.create_timer(1.0, self.health_check)\n\n    def health_check(self):\n        # Monitor system health\n        if not self.is_system_healthy():\n            self.enter_safe_mode()\n\n    def is_system_healthy(self):\n        # Check critical systems\n        return self.check_sensors() and self.check_actuators()\n\n    def enter_safe_mode(self):\n        # Enter safe state when problems detected\n        self.get_logger().warn('Entering safe mode due to system issues')\n        # Stop all movement and wait for recovery\n"})}),"\n",(0,a.jsx)(n.h2,{id:"testing-and-debugging",children:"Testing and Debugging"}),"\n",(0,a.jsx)(n.h3,{id:"unit-testing-ai-agents",children:"Unit Testing AI Agents"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import unittest\nfrom unittest.mock import Mock, patch\n\nclass TestAgent(unittest.TestCase):\n    def setUp(self):\n        # Setup test environment\n        self.agent = SimpleAgent()\n\n    def test_initialization(self):\n        # Test agent initialization\n        self.assertIsNotNone(self.agent)\n\n    def test_callback_execution(self):\n        # Test callback execution\n        with patch.object(self.agent, 'publisher') as mock_pub:\n            self.agent.timer_callback()\n            mock_pub.publish.assert_called_once()\n"})}),"\n",(0,a.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,a.jsxs)(n.p,{children:["Python AI agents with ",(0,a.jsx)(n.code,{children:"rclpy"})," provide a powerful foundation for creating intelligent humanoid robots. By understanding the core concepts and implementing proper communication patterns, developers can create robust agents that seamlessly integrate with the broader ROS 2 ecosystem. The examples in this chapter demonstrate how to build agents that can process sensor data, make decisions, and interact with other components in a safe and efficient manner."]}),"\n",(0,a.jsx)(n.p,{children:"This chapter has laid the groundwork for understanding how AI agents function within the ROS 2 framework, preparing readers for more complex implementations in subsequent chapters."})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>r,x:()=>l});var s=t(6540);const a={},i=s.createContext(a);function r(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);